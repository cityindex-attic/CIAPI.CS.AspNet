/*!
 * AmplifyJS 1.0.0 - Core, Store, Request
 * 
 * Copyright 2011 appendTo LLC. (http://appendto.com/team)
 * Dual licensed under the MIT or GPL licenses.
 * http://appendto.com/open-source-licenses
 * 
 * http://amplifyjs.com
 */
(function(a,b){var c=[].slice,d={},e=a.amplify={publish:function(a){var b=c.call(arguments,1),e,f,g=0,h;if(!d[a])return!0;for(f=d[a].length;g<f;g++){e=d[a][g],h=e.callback.apply(e.context,b);if(h===!1)break}return h!==!1},subscribe:function(a,b,c,e){arguments.length===3&&typeof c=="number"&&(e=c,c=b,b=null),arguments.length===2&&(c=b,b=null),e=e||10;var f=0,g=a.split(/\s/),h=g.length;for(;f<h;f++){a=g[f],d[a]||(d[a]=[]);var i=d[a].length-1,j={callback:c,context:b,priority:e};for(;i>=0;i--)if(d[a][i].priority<=e){d[a].splice(i+1,0,j);return c}d[a].unshift(j)}return c},unsubscribe:function(a,b){if(!!d[a]){var c=d[a].length,e=0;for(;e<c;e++)if(d[a][e].callback===b){d[a].splice(e,1);break}}}}})(this),function(a,b){function e(a,e){c.addType(a,function(f,g,h){var i,j,k,l,m=g,n=(new Date).getTime();if(!f){m={},l=[],k=0;try{f=e.length;while(f=e.key(k++))d.test(f)&&(j=JSON.parse(e.getItem(f)),j.expires&&j.expires<=n?l.push(f):m[f.replace(d,"")]=j.data);while(f=l.pop())e.removeItem(f)}catch(o){}return m}f="__amplify__"+f;if(g===b){i=e.getItem(f),j=i?JSON.parse(i):{expires:-1};if(j.expires&&j.expires<=n)e.removeItem(f);else return j.data}else if(g===null)e.removeItem(f);else{j=JSON.stringify({data:g,expires:h.expires?n+h.expires:null});try{e.setItem(f,j)}catch(o){c[a]();try{e.setItem(f,j)}catch(o){throw c.error()}}}return m})}var c=a.store=function(a,b,d,e){var e=c.type;d&&d.type&&d.type in c.types&&(e=d.type);return c.types[e](a,b,d||{})};c.types={},c.type=null,c.addType=function(a,b){c.type||(c.type=a),c.types[a]=b,c[a]=function(b,d,e){e=e||{},e.type=a;return c(b,d,e)}},c.error=function(){return"amplify.store quota exceeded"};var d=/^__amplify__/;for(var f in{localStorage:1,sessionStorage:1})try{window[f].getItem&&e(f,window[f])}catch(g){}if(window.globalStorage)try{e("globalStorage",window.globalStorage[window.location.hostname]),c.type==="sessionStorage"&&(c.type="globalStorage")}catch(g){}(function(){if(!c.types.localStorage){var a=document.createElement("div"),d="amplify";a.style.display="none",document.getElementsByTagName("head")[0].appendChild(a),a.addBehavior&&(a.addBehavior("#default#userdata"),c.addType("userData",function(e,f,g){a.load(d);var h,i,j,k,l,m=f,n=(new Date).getTime();if(!e){m={},l=[],k=0;while(h=a.XMLDocument.documentElement.attributes[k++])i=JSON.parse(h.value),i.expires&&i.expires<=n?l.push(h.name):m[h.name]=i.data;while(e=l.pop())a.removeAttribute(e);a.save(d);return m}e=e.replace(/[^-._0-9A-Za-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u37f-\u1fff\u200c-\u200d\u203f\u2040\u2070-\u218f]/g,"-");if(f===b){h=a.getAttribute(e),i=h?JSON.parse(h):{expires:-1};if(i.expires&&i.expires<=n)a.removeAttribute(e);else return i.data}else f===null?a.removeAttribute(e):(j=a.getAttribute(e),i=JSON.stringify({data:f,expires:g.expires?n+g.expires:null}),a.setAttribute(e,i));try{a.save(d)}catch(o){j===null?a.removeAttribute(e):a.setAttribute(e,j),c.userData();try{a.setAttribute(e,i),a.save(d)}catch(o){j===null?a.removeAttribute(e):a.setAttribute(e,j);throw c.error()}}return m}))}})(),function(){function d(a){return a===b?b:JSON.parse(JSON.stringify(a))}var a={};c.addType("memory",function(c,e,f){if(!c)return d(a);if(e===b)return d(a[c]);if(e===null){delete a[c];return null}a[c]=e,f.expires&&setTimeout(function(){delete a[c]},f.expires);return e})}()}(this.amplify=this.amplify||{}),function(a,b){function d(a){return{}.toString.call(a)==="[object Function]"}function c(){}a.request=function(b,e,f){var g=b||{};typeof g=="string"&&(d(e)&&(f=e,e={}),g={resourceId:b,data:e||{},success:f});var h={abort:c},i=a.request.resources[g.resourceId],j=g.success||c,k=g.error||c;g.success=function(b,c){c=c||"success",a.publish("request.success",g,b,c),a.publish("request.complete",g,b,c),j(b,c)},g.error=function(b,c){c=c||"error",a.publish("request.error",g,b,c),a.publish("request.complete",g,b,c),k(b,c)};if(!i){if(!g.resourceId)throw"amplify.request: no resourceId provided";throw"amplify.request: unknown resourceId: "+g.resourceId}if(!a.publish("request.before",g))g.error(null,"abort");else{a.request.resources[g.resourceId](g,h);return h}},a.request.types={},a.request.resources={},a.request.define=function(b,c,d){if(typeof c=="string"){if(!(c in a.request.types))throw"amplify.request.define: unknown type: "+c;d.resourceId=b,a.request.resources[b]=a.request.types[c](d)}else a.request.resources[b]=c}}(amplify),function(a,b,c){var d=["status","statusText","responseText","responseXML","readyState"],e=/\{([^\}]+)\}/g;a.request.types.ajax=function(f){f=b.extend({type:"GET"},f);return function(g,h){function q(a,e){b.each(d,function(a,b){try{p[b]=i[b]}catch(c){}}),/OK$/.test(p.statusText)&&(p.statusText="success"),a===c&&(a=null),o&&(e="abort"),/timeout|error|abort/.test(e)?p.error(a,e):p.success(a,e),q=b.noop}var i,j=f.url,k=g.data,l=h.abort,m={},n=[],o=!1,p={readyState:0,setRequestHeader:function(a,b){return i.setRequestHeader(a,b)},getAllResponseHeaders:function(){return i.getAllResponseHeaders()},getResponseHeader:function(a){return i.getResponseHeader(a)},overrideMimeType:function(a){return i.overrideMideType(a)},abort:function(){o=!0;try{i.abort()}catch(a){}q(null,"abort")},success:function(a,b){g.success(a,b)},error:function(a,b){g.error(a,b)}};typeof k!="string"&&(k=b.extend(!0,{},f.data,k),j=j.replace(e,function(a,b){if(b in k){n.push(b);return k[b]}}),b.each(n,function(a,b){delete k[b]})),b.extend(m,f,{url:j,type:f.type,data:k,dataType:f.dataType,success:function(a,b){q(a,b)},error:function(a,b){q(null,b)},beforeSend:function(b,c){i=b,m=c;var d=f.beforeSend?f.beforeSend.call(this,p,m):!0;return d&&a.publish("request.before.ajax",f,g,m,p)}}),b.ajax(m),h.abort=function(){p.abort(),l.call(this)}}};var f=a.request.cache={_key:function(a,b,c){function g(){return c.charCodeAt(e++)<<24|c.charCodeAt(e++)<<16|c.charCodeAt(e++)<<8|c.charCodeAt(e++)<<0}c=b+c;var d=c.length,e=0,f=g();while(e<d)f^=g();return"request-"+a+"-"+f},_default:function(){var a={};return function(b,c,d,e){var g=f._key(c.resourceId,d.url,d.data),h=b.cache;if(g in a){e.success(a[g]);return!1}var i=e.success;e.success=function(b){a[g]=b,typeof h=="number"&&setTimeout(function(){delete a[g]},h),i.apply(this,arguments)}}}()};a.store&&(b.each(a.store.types,function(b){f[b]=function(c,d,e,g){var h=f._key(d.resourceId,e.url,e.data),i=a.store[b](h);if(i){e.success(i);return!1}var j=g.success;g.success=function(d){a.store[b](h,d,{expires:c.cache.expires}),j.apply(this,arguments)}}}),f.persist=f[a.store.type]),a.subscribe("request.before.ajax",function(a){var b=a.cache;if(b){b=b.type||b;return f[b in f?b:"_default"].apply(this,arguments)}}),a.request.decoders={jsend:function(a,b,c,d,e){a.status==="success"?d(a.data):a.status==="fail"?e(a.data,"fail"):a.status==="error"&&(delete a.status,e(a,"error"))}},a.subscribe("request.before.ajax",function(c,d,e,f){function k(a,b){h(a,b)}function j(a,b){g(a,b)}var g=f.success,h=f.error,i=b.isFunction(c.decoder)?c.decoder:c.decoder in a.request.decoders?a.request.decoders[c.decoder]:a.request.decoders._default;!i||(f.success=function(a,b){i(a,b,f,j,k)},f.error=function(a,b){i(a,b,f,j,k)})})}(amplify,jQuery);

// Underscore.js 1.1.6
// (c) 2011 Jeremy Ashkenas, DocumentCloud Inc.
// Underscore is freely distributable under the MIT license.
// Portions of Underscore are inspired or borrowed from Prototype,
// Oliver Steele's Functional, and John Resig's Micro-Templating.
// For all details and documentation:
// http://documentcloud.github.com/underscore
(function(){var p=this,C=p._,m={},i=Array.prototype,n=Object.prototype,f=i.slice,D=i.unshift,E=n.toString,l=n.hasOwnProperty,s=i.forEach,t=i.map,u=i.reduce,v=i.reduceRight,w=i.filter,x=i.every,y=i.some,o=i.indexOf,z=i.lastIndexOf;n=Array.isArray;var F=Object.keys,q=Function.prototype.bind,b=function(a){return new j(a)};typeof module!=="undefined"&&module.exports?(module.exports=b,b._=b):p._=b;b.VERSION="1.1.6";var h=b.each=b.forEach=function(a,c,d){if(a!=null)if(s&&a.forEach===s)a.forEach(c,d);else if(b.isNumber(a.length))for(var e=
0,k=a.length;e<k;e++){if(c.call(d,a[e],e,a)===m)break}else for(e in a)if(l.call(a,e)&&c.call(d,a[e],e,a)===m)break};b.map=function(a,c,b){var e=[];if(a==null)return e;if(t&&a.map===t)return a.map(c,b);h(a,function(a,g,G){e[e.length]=c.call(b,a,g,G)});return e};b.reduce=b.foldl=b.inject=function(a,c,d,e){var k=d!==void 0;a==null&&(a=[]);if(u&&a.reduce===u)return e&&(c=b.bind(c,e)),k?a.reduce(c,d):a.reduce(c);h(a,function(a,b,f){!k&&b===0?(d=a,k=!0):d=c.call(e,d,a,b,f)});if(!k)throw new TypeError("Reduce of empty array with no initial value");
return d};b.reduceRight=b.foldr=function(a,c,d,e){a==null&&(a=[]);if(v&&a.reduceRight===v)return e&&(c=b.bind(c,e)),d!==void 0?a.reduceRight(c,d):a.reduceRight(c);a=(b.isArray(a)?a.slice():b.toArray(a)).reverse();return b.reduce(a,c,d,e)};b.find=b.detect=function(a,c,b){var e;A(a,function(a,g,f){if(c.call(b,a,g,f))return e=a,!0});return e};b.filter=b.select=function(a,c,b){var e=[];if(a==null)return e;if(w&&a.filter===w)return a.filter(c,b);h(a,function(a,g,f){c.call(b,a,g,f)&&(e[e.length]=a)});return e};
b.reject=function(a,c,b){var e=[];if(a==null)return e;h(a,function(a,g,f){c.call(b,a,g,f)||(e[e.length]=a)});return e};b.every=b.all=function(a,c,b){var e=!0;if(a==null)return e;if(x&&a.every===x)return a.every(c,b);h(a,function(a,g,f){if(!(e=e&&c.call(b,a,g,f)))return m});return e};var A=b.some=b.any=function(a,c,d){c||(c=b.identity);var e=!1;if(a==null)return e;if(y&&a.some===y)return a.some(c,d);h(a,function(a,b,f){if(e=c.call(d,a,b,f))return m});return e};b.include=b.contains=function(a,c){var b=
!1;if(a==null)return b;if(o&&a.indexOf===o)return a.indexOf(c)!=-1;A(a,function(a){if(b=a===c)return!0});return b};b.invoke=function(a,c){var d=f.call(arguments,2);return b.map(a,function(a){return(c.call?c||a:a[c]).apply(a,d)})};b.pluck=function(a,c){return b.map(a,function(a){return a[c]})};b.max=function(a,c,d){if(!c&&b.isArray(a))return Math.max.apply(Math,a);var e={computed:-Infinity};h(a,function(a,b,f){b=c?c.call(d,a,b,f):a;b>=e.computed&&(e={value:a,computed:b})});return e.value};b.min=function(a,
c,d){if(!c&&b.isArray(a))return Math.min.apply(Math,a);var e={computed:Infinity};h(a,function(a,b,f){b=c?c.call(d,a,b,f):a;b<e.computed&&(e={value:a,computed:b})});return e.value};b.sortBy=function(a,c,d){return b.pluck(b.map(a,function(a,b,f){return{value:a,criteria:c.call(d,a,b,f)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;return c<d?-1:c>d?1:0}),"value")};b.sortedIndex=function(a,c,d){d||(d=b.identity);for(var e=0,f=a.length;e<f;){var g=e+f>>1;d(a[g])<d(c)?e=g+1:f=g}return e};b.toArray=
function(a){if(!a)return[];if(a.toArray)return a.toArray();if(b.isArray(a))return a;if(b.isArguments(a))return f.call(a);return b.values(a)};b.size=function(a){return b.toArray(a).length};b.first=b.head=function(a,b,d){return b!=null&&!d?f.call(a,0,b):a[0]};b.rest=b.tail=function(a,b,d){return f.call(a,b==null||d?1:b)};b.last=function(a){return a[a.length-1]};b.compact=function(a){return b.filter(a,function(a){return!!a})};b.flatten=function(a){return b.reduce(a,function(a,d){if(b.isArray(d))return a.concat(b.flatten(d));
a[a.length]=d;return a},[])};b.without=function(a){var c=f.call(arguments,1);return b.filter(a,function(a){return!b.include(c,a)})};b.uniq=b.unique=function(a,c){return b.reduce(a,function(a,e,f){if(0==f||(c===!0?b.last(a)!=e:!b.include(a,e)))a[a.length]=e;return a},[])};b.intersect=function(a){var c=f.call(arguments,1);return b.filter(b.uniq(a),function(a){return b.every(c,function(c){return b.indexOf(c,a)>=0})})};b.zip=function(){for(var a=f.call(arguments),c=b.max(b.pluck(a,"length")),d=Array(c),
e=0;e<c;e++)d[e]=b.pluck(a,""+e);return d};b.indexOf=function(a,c,d){if(a==null)return-1;var e;if(d)return d=b.sortedIndex(a,c),a[d]===c?d:-1;if(o&&a.indexOf===o)return a.indexOf(c);d=0;for(e=a.length;d<e;d++)if(a[d]===c)return d;return-1};b.lastIndexOf=function(a,b){if(a==null)return-1;if(z&&a.lastIndexOf===z)return a.lastIndexOf(b);for(var d=a.length;d--;)if(a[d]===b)return d;return-1};b.range=function(a,b,d){arguments.length<=1&&(b=a||0,a=0);d=arguments[2]||1;for(var e=Math.max(Math.ceil((b-a)/
d),0),f=0,g=Array(e);f<e;)g[f++]=a,a+=d;return g};b.bind=function(a,b){if(a.bind===q&&q)return q.apply(a,f.call(arguments,1));var d=f.call(arguments,2);return function(){return a.apply(b,d.concat(f.call(arguments)))}};b.bindAll=function(a){var c=f.call(arguments,1);c.length==0&&(c=b.functions(a));h(c,function(c){a[c]=b.bind(a[c],a)});return a};b.memoize=function(a,c){var d={};c||(c=b.identity);return function(){var b=c.apply(this,arguments);return l.call(d,b)?d[b]:d[b]=a.apply(this,arguments)}};b.delay=
function(a,b){var d=f.call(arguments,2);return setTimeout(function(){return a.apply(a,d)},b)};b.defer=function(a){return b.delay.apply(b,[a,1].concat(f.call(arguments,1)))};var B=function(a,b,d){var e;return function(){var f=this,g=arguments,h=function(){e=null;a.apply(f,g)};d&&clearTimeout(e);if(d||!e)e=setTimeout(h,b)}};b.throttle=function(a,b){return B(a,b,!1)};b.debounce=function(a,b){return B(a,b,!0)};b.once=function(a){var b=!1,d;return function(){if(b)return d;b=!0;return d=a.apply(this,arguments)}};
b.wrap=function(a,b){return function(){var d=[a].concat(f.call(arguments));return b.apply(this,d)}};b.compose=function(){var a=f.call(arguments);return function(){for(var b=f.call(arguments),d=a.length-1;d>=0;d--)b=[a[d].apply(this,b)];return b[0]}};b.after=function(a,b){return function(){if(--a<1)return b.apply(this,arguments)}};b.keys=F||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[],d;for(d in a)l.call(a,d)&&(b[b.length]=d);return b};b.values=function(a){return b.map(a,
b.identity)};b.functions=b.methods=function(a){return b.filter(b.keys(a),function(c){return b.isFunction(a[c])}).sort()};b.extend=function(a){h(f.call(arguments,1),function(b){for(var d in b)b[d]!==void 0&&(a[d]=b[d])});return a};b.defaults=function(a){h(f.call(arguments,1),function(b){for(var d in b)a[d]==null&&(a[d]=b[d])});return a};b.clone=function(a){return b.isArray(a)?a.slice():b.extend({},a)};b.tap=function(a,b){b(a);return a};b.isEqual=function(a,c){if(a===c)return!0;var d=typeof a;if(d!=
typeof c)return!1;if(a==c)return!0;if(!a&&c||a&&!c)return!1;if(a._chain)a=a._wrapped;if(c._chain)c=c._wrapped;if(a.isEqual)return a.isEqual(c);if(b.isDate(a)&&b.isDate(c))return a.getTime()===c.getTime();if(b.isNaN(a)&&b.isNaN(c))return!1;if(b.isRegExp(a)&&b.isRegExp(c))return a.source===c.source&&a.global===c.global&&a.ignoreCase===c.ignoreCase&&a.multiline===c.multiline;if(d!=="object")return!1;if(a.length&&a.length!==c.length)return!1;d=b.keys(a);var e=b.keys(c);if(d.length!=e.length)return!1;
for(var f in a)if(!(f in c)||!b.isEqual(a[f],c[f]))return!1;return!0};b.isEmpty=function(a){if(b.isArray(a)||b.isString(a))return a.length===0;for(var c in a)if(l.call(a,c))return!1;return!0};b.isElement=function(a){return!!(a&&a.nodeType==1)};b.isArray=n||function(a){return E.call(a)==="[object Array]"};b.isArguments=function(a){return!(!a||!l.call(a,"callee"))};b.isFunction=function(a){return!(!a||!a.constructor||!a.call||!a.apply)};b.isString=function(a){return!!(a===""||a&&a.charCodeAt&&a.substr)};
b.isNumber=function(a){return!!(a===0||a&&a.toExponential&&a.toFixed)};b.isNaN=function(a){return a!==a};b.isBoolean=function(a){return a===!0||a===!1};b.isDate=function(a){return!(!a||!a.getTimezoneOffset||!a.setUTCFullYear)};b.isRegExp=function(a){return!(!a||!a.test||!a.exec||!(a.ignoreCase||a.ignoreCase===!1))};b.isNull=function(a){return a===null};b.isUndefined=function(a){return a===void 0};b.noConflict=function(){p._=C;return this};b.identity=function(a){return a};b.times=function(a,b,d){for(var e=
0;e<a;e++)b.call(d,e)};b.mixin=function(a){h(b.functions(a),function(c){H(c,b[c]=a[c])})};var I=0;b.uniqueId=function(a){var b=I++;return a?a+b:b};b.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g};b.template=function(a,c){var d=b.templateSettings;d="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+a.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(d.interpolate,function(a,b){return"',"+b.replace(/\\'/g,"'")+",'"}).replace(d.evaluate||
null,function(a,b){return"');"+b.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+"__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');";d=new Function("obj",d);return c?d(c):d};var j=function(a){this._wrapped=a};b.prototype=j.prototype;var r=function(a,c){return c?b(a).chain():a},H=function(a,c){j.prototype[a]=function(){var a=f.call(arguments);D.call(a,this._wrapped);return r(c.apply(b,a),this._chain)}};b.mixin(b);h(["pop","push","reverse","shift","sort",
"splice","unshift"],function(a){var b=i[a];j.prototype[a]=function(){b.apply(this._wrapped,arguments);return r(this._wrapped,this._chain)}});h(["concat","join","slice"],function(a){var b=i[a];j.prototype[a]=function(){return r(b.apply(this._wrapped,arguments),this._chain)}});j.prototype.chain=function(){this._chain=!0;return this};j.prototype.value=function(){return this._wrapped}})();


var CIAPI=CIAPI||{};CIAPI.dto=CIAPI.dto||{};CIAPI.version="0.1";CIAPI.settings={};CIAPI.parseDate=function(b){if(b.toString().indexOf("Date")>=0){a=/^\/Date\((-?[0-9]+)\)\/$/.exec(b);if(a){return new Date(parseInt(a[1],10))}}};if(typeof Object.freeze=="undefined"){Object.freeze=function(){}}if(typeof Object.isFrozen=="undefined"){Object.isFrozen=function(){return false}}if(typeof String.trim=="undefined"){String.prototype.trim=function(){return this.replace(/^\s*(\S*(\s+\S+)*)\s*$/,"$1")}};
(function(d){d.flXHRproxy=flensed.flXHR;var c=[],b=/^(?:post|get)$/i,a={instancePooling:true,autoUpdatePlayer:true};d.flXHRproxy.registerOptions=function(f,e){e=d.extend({},a,e||{});c.push(function(g){if(g.substring(0,f.length)===f){return e}})};d.ajaxPrefilter(function(e){var h,g;if(e.async&&b.test(e.type)){for(var f=0;f<c.length;f++){if(g=c[f](e.url)){h=g}}if(h||e.flXHR){e.flXHROptions=h||a;return"__flxhr__"}}});d.ajaxTransport("__flxhr__",function(e,f,g){e.dataTypes.shift();if(!e.async){return}var h;return{send:function(o,j){var k=e.flXHROptions||a,n=g.__flXHR__=new d.flXHRproxy(k),m;h=function(i,p){if(h&&(p||n.readyState===4)){h=n.onreadystatechange=n.onerror=null;if(p){if(!(m=(p!=="abort"))){n.abort()}j(i,p)}else{var q={},r=n.responseXML;if(r&&r.documentElement){q.xml=r}q.text=n.responseText;j(n.status,n.statusText,q,n.getAllResponseHeaders())}}};if(d.isFunction(k.onerror)){g.fail(function(){if(m){k.onerror.apply(this,arguments)}})}n.onreadystatechange=h;n.onerror=function(i){j(-1,i)};n.open(e.type,e.url,e.async,e.username,e.password);for(var l in o){n.setRequestHeader(l,o[l])}n.send((e.hasContent&&e.data)||null)},abort:function(){if(h){h(0,"abort")}}}})})(jQuery);(function(a,d,e){var c=["status","statusText","responseText","responseXML","readyState"],b=/\{([^\}]+)\}/g;if(!d.support.cors){d.flXHRproxy.registerOptions("",{xmlResponseText:false})}a.request.types.cors=function(f){f=d.extend({type:"GET"},f);return function(i,j){var q,h=f.url,l=i.data,k=j.abort,p={},o=[],g=false,n={readyState:0,setRequestHeader:function(r,s){if(q.__flXHR__){console.log("WARNING: This browser requires the use of flXHR for CORS requests, which does not allow setting request headers.  Either use a different browser, or do not set request headers")}return q.setRequestHeader(r,s)},getAllResponseHeaders:function(){if(q.__flXHR__){console.log("WARNING: This browser requires the use of flXHR for CORS requests, which does not allow access to response headers.  Either use a different browser, or do not attempt to access response headers");return""}var r=q.getAllResponseHeaders();if(!r){console.log("WARNING: This browser isn't allowing access to the response headers.  This could be because the browser doesn't allow accessing response headers in CORS requests; or the server is not returning the Access-Control-Expose-Headers: header1, header2, etc...");return""}return r},getResponseHeader:function(r){if(q.__flXHR__){console.log("WARNING: This browser requires the use of flXHR for CORS requests, which does not allow access to response headers.  Either use a different browser, or do not attempt to access response headers");return""}var s=q.getResponseHeader(r);if(!s){console.log("WARNING: This browser isn't allowing access to the  "+r+" response header.  This could be because the browser doesn't allow accessing response headers in CORS requests; or the server is not returning the Access-Control-Expose-Headers: "+r+" header");return""}return s;return},overrideMimeType:function(r){return q.overrideMideType(r)},abort:function(){g=true;try{q.abort()}catch(r){}m(null,"abort")},success:function(s,r){i.success(s,r)},error:function(s,r){i.error(s,r)}};if(typeof l!=="string"){l=d.extend(true,{},f.data,l);h=h.replace(b,function(r,s){if(s in l){o.push(s);return l[s]}});d.each(o,function(s,r){delete l[r]})}d.extend(p,f,{url:h,type:f.type,data:l,dataType:f.dataType,success:function(s,r){m(s,r)},error:function(s,r){m(null,r)},beforeSend:function(t,s){q=t;p=s;var r=f.beforeSend?f.beforeSend.call(this,n,p):true;return r&&a.publish("request.before.ajax",f,i,p,n)}});if(!d.support.cors){p.transport="flXHRproxy"}d.ajax(p);function m(s,r){d.each(c,function(u,t){try{n[t]=q[t]}catch(v){}});if(/OK$/.test(n.statusText)){n.statusText="success"}if(s===e){s=null}if(g){r="abort"}if(/timeout|error|abort/.test(r)){n.error(s,r)}else{n.success(s,r)}m=d.noop}j.abort=function(){n.abort();k.call(this)}}}})(amplify,jQuery);
var CIAPI=CIAPI||{};CIAPI.__testData=(function(){try{var c,b,d=[],i={},e,a,g=function(j){var k=Math.random()>0.5?1:-1;return j.Close+(k*j.Close*0.05)},f=function(m,k){var j={minute:1000*60,hour:1000*60*60,day:1000*60*60*24};var l=new Date(m.BarDate.getTime()-j[k]);var n=g(m);return{BarDate:l,Close:n,High:n*(Math.random()+1),Low:n*(1-Math.random()),Open:m.Close}};for(c=0;c<=100;c++){e={BarDate:new Date(),Close:1.6283,High:1.6285,Low:1.6283,Open:1.6284};a={MarketId:c,Name:"{marketName} CFD #"+(c+1),PriceHistory:{minute:[]}};for(b=0;b<=1000;b++){a.PriceHistory.minute.push(e);e=f(e,"minute")}d.push(a)}return{MarketList:d}}catch(h){console.log(h)}})();
(function(a,b,c){CIAPI.subscribe=function(d,e){return a.subscribe(d,e)};CIAPI.publish=function(d,e){return a.publish(d,e)}})(amplify,_);
(function(a,b,c){CIAPI.store=function(e,f,d){return a.store(e,f,d)};CIAPI.storeInCookie=function(e,m,p){if(typeof m!="undefined"){p=p||{};if(m===null){m="";p.expires=-1}var h="";if(p.expires&&(typeof p.expires=="number"||p.expires.toUTCString)){var j;if(typeof p.expires=="number"){j=new Date();j.setTime(j.getTime()+(p.expires*24*60*60*1000))}else{j=p.expires}h="; expires="+j.toUTCString()}var o=p.path?"; path="+(p.path):"";var k=p.domain?"; domain="+(p.domain):"";var d=p.secure?"; secure":"";document.cookie=[e,"=",encodeURIComponent(m),h,o,k,d].join("")}else{var g=null;if(document.cookie&&document.cookie!=""){var n=document.cookie.split(";");for(var l=0;l<n.length;l++){var f=n[l].trim();if(f.substring(0,e.length+1)==(e+"=")){g=decodeURIComponent(f.substring(e.length+1));break}}}return g}}})(amplify,_);
(function(a,b,c){a.request.decoders.ciapiDecoder=function(f,d,h,g,e){if(d==="timeout"){e(new CIAPI.dto.ApiErrorResponseDTO(503,503,"Request timed out when contacting server"));return}if(!b(f).isNull()&&!b(f).isUndefined(f)&&!f.ErrorCode){g(f)}else{e(f)}};a.request.define("createSession","cors",{url:"{ServiceUri}/session?only200=true",timeout:5000,dataType:"json",contentType:"application/json; charset=utf-8",type:"POST",processData:false,beforeSend:function(e,d){d.data=JSON.stringify(d.data);return true},decoder:"ciapiDecoder"});a.request.define("DeleteSession","cors",{url:"{ServiceUri}/session?_method=DELETE&only200=true",dataType:"json",contentType:"application/json; charset=utf-8",type:"POST",processData:false,beforeSend:function(e,d){d.data=JSON.stringify(d.data);return true},decoder:"ciapiDecoder"});a.request.define("ListCfdMarkets","cors",{url:"{ServiceUri}/cfd/markets?MarketName={searchByMarketName}&MarketCode={searchByMarketCode}&ClientAccountId={clientAccountId}&MaxResults={maxResults}&only200=true",dataType:"json",contentType:"application/json; charset=utf-8",type:"GET",decoder:"ciapiDecoder"});a.request.define("GetPriceBars","cors",{url:"{ServiceUri}/market/{marketId}/barhistory?interval={interval}&span={span}&priceBars={maxResults}&only200=true",dataType:"json",contentType:"application/json; charset=utf-8",type:"GET",decoder:"ciapiDecoder"})})(amplify,_);
var CIAPI=CIAPI||{};(function(a,b,c){CIAPI.connection=CIAPI.store("CIAPI.connection")||{};b(CIAPI.connection).defaults({isConnected:false,UserName:"",Session:"",ServiceUri:"",StreamUri:""});CIAPI.connect=function(e){b(e).defaults({UserName:CIAPI.connection.UserName,Password:c,ServiceUri:CIAPI.connection.ServiceUri,StreamUri:CIAPI.connection.StreamUri,success:function(){},error:function(){}});var d=a.request({resourceId:"createSession",data:{ServiceUri:e.ServiceUri,UserName:e.UserName,Password:e.Password},success:function(f){CIAPI.connection.isConnected=true;CIAPI.connection.UserName=e.UserName;CIAPI.connection.Session=f.Session;CIAPI.store("CIAPI.connection",CIAPI.connection);CIAPI.storeInCookie("UserName",CIAPI.connection.UserName);CIAPI.storeInCookie("Session",CIAPI.connection.Session);e.success(f)},error:function(f){CIAPI.connection.isConnected=false;CIAPI.connection.Session="";CIAPI.store("CIAPI.connection",CIAPI.connection);CIAPI.storeInCookie("UserName","");CIAPI.storeInCookie("Session","");e.error(f)}})};CIAPI.disconnect=function(d){d=d||{};b(d).defaults({UserName:CIAPI.connection.UserName,Session:CIAPI.connection.Session,ServiceUri:CIAPI.connection.ServiceUri,success:function(){},error:function(){}});a.request({resourceId:"DeleteSession",data:{ServiceUri:d.ServiceUri,UserName:d.UserName,Session:d.Session},success:function(e){CIAPI.connection.isConnected=false;CIAPI.connection.UserName="";CIAPI.connection.Session="";CIAPI.store("CIAPI.connection",CIAPI.connection);CIAPI.storeInCookie("UserName","");CIAPI.storeInCookie("Session","");d.success(e)},error:function(e){d.error(e)}})}})(amplify,_);
var CIAPI=CIAPI||{};CIAPI.dojo={};(function(){var f=CIAPI.dojo,c=Object.prototype.toString;f.isArray=function(d){return d&&(d instanceof Array||typeof d=="array")};f.isFunction=function(d){return c.call(d)==="[object Function]"};f._extraNames=a=a||["hasOwnProperty","valueOf","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","constructor"];var a=f._extraNames,b=a.length,e={};f.clone=function(m){if(!m||typeof m!="object"||f.isFunction(m)){return m}if(m.nodeType&&"cloneNode" in m){return m.cloneNode(true)}if(m instanceof Date){return new Date(m.getTime())}if(m instanceof RegExp){return new RegExp(m)}var k,h,d,j,g;if(f.isArray(m)){k=[];for(h=0,d=m.length;h<d;++h){if(h in m){k.push(f.clone(m[h]))}}}else{k=m.constructor?new m.constructor():{}}for(g in m){j=m[g];if(!(g in k)||(k[g]!==j&&(!(g in e)||e[g]!==j))){k[g]=f.clone(j)}}if(b){for(h=0;h<b;++h){g=a[h];j=m[g];if(!(g in k)||(k[g]!==j&&(!(g in e)||e[g]!==j))){k[g]=j}}}return k}})();
if(typeof console=="undefined"||typeof console.log=="undefined"){var console={log:function(){}}}CIAPI.log=function(a){console.log(a)};
var CIAPI=CIAPI||{};CIAPI.services=(function(){return{ListCfdMarkets:function(a){_(a).defaults({NameStartsWith:undefined,CodeStartsWith:undefined,MaxResults:25,success:function(){},error:function(){}});amplify.request({resourceId:"ListCfdMarkets",data:{ServiceUri:CIAPI.connection.ServiceUri,searchByMarketName:a.NameStartsWith,searchByMarketCode:a.CodeStartsWith,maxResults:a.MaxResults},success:function(b){a.success(b)},error:function(b){a.error(b)}})},GetPriceBars:function(a){_(a).defaults({MarketId:undefined,Interval:"minute",Span:1,MaxResults:25,success:function(){},error:function(){}});amplify.request({resourceId:"GetPriceBars",data:{ServiceUri:CIAPI.connection.ServiceUri,marketId:a.MarketId,interval:a.Interval,span:a.Span,maxResults:a.MaxResults},success:function(b){a.success(b)},error:function(b){a.error(b)}})}}})();
var CIAPI=CIAPI||{};CIAPI.streams=(function(){var a={};return{SubscribeToPrice:function(c){_(c).defaults({MarketId:undefined,message:function(d){console.log(d)}});var b="PRICE."+c.MarketId;a[b]=amplify.subscribe(b,function(d){c.message(d);return true})},UnsubscribeFromPrice:function(c){var b="PRICE."+c.MarketId;amplify.unsubscribe(b,a[b])}}})();
CIAPI.dto.ApiErrorResponseDTO=function(b,c,a){this.HttpStatus=b;this.ErrorCode=c;this.ErrorMessage=a;Object.freeze(this)};
CIAPI.dto.CreateSessionResponseDTO=function(a){this.Session=a;Object.freeze(this)};
CIAPI.dto.ListCfdMarketsResponseDTO=function(a){this.Markets=a;Object.freeze(this)};
CIAPI.dto.PriceBarDTO=function(d,b,c,a,e){this.BarDate=d;this.Open=b;this.High=c;this.Low=a;this.Close=e;Object.freeze(this)};
CIAPI.dto.PriceDTO=function(d,b,a,c,e){this.MarketId=d;this.TickDate=b;this.Bid=a;this.Offer=c;this.Change=e;Object.freeze(this)};

