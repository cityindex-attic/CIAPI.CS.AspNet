(function(a,b){a.widget("ui.CIAPI_widget_AuthenticationWidget",a.ui.CIAPI_widget,{options:{width:600,afterLogOn:function(c){},afterLogOff:function(c){},template:a.template("defaultAuthWidgetTemplate",'<div id="login_message"></div>                                                              <p>                                                                                             <label for="username">Username<br />                                                        <input type="text"                                                                                  name="username"                                                                             id="username"                                                                               class="inputFields"                                                                         data-bind="value: username"                                                                 size="20"                                                                                   tabindex="1" />                                                                     </label>                                                                                </p>                                                                                        <p>                                                                                             <label for="password">Password<br />                                                        <input type="password"                                                                              name="password"                                                                             id="password"                                                                               class="inputFields"                                                                         data-bind="value: password"                                                                 size="20"                                                                                   tabindex="2" />                                                                     </label>                                                                                </p>                                                                                        <p class="submit">                                                                              <button id="doLogOnButton" data-bind="click: doLogOn" tabindex="3">Log on</button></p>                                                                                        ')},_createViewModel:function(c){return{widget:c,username:ko.observable(CIAPI.connection.UserName),password:ko.observable(""),activeView:ko.observable("LogOn"),errorMessage:ko.observable(""),doLogOn:function(){var d=this;CIAPI.connect({UserName:d.username(),Password:d.password(),success:function(e){d.widget.options.afterLogOn(CIAPI.connection);d.errorMessage("");d.widget._update()},error:function(e){d.errorMessage("ERROR: "+e.ErrorMessage);d.widget._update()}})},doLogOff:function(){var d=this;CIAPI.disconnect({success:function(e){d.widget.options.afterLogOff(CIAPI.connection);d.widget._update()}})}}},_create:function(){this.options.viewModel=this._createViewModel(this);a.tmpl(this.options.template,{}).appendTo(this.element);ko.applyBindings(this.options.viewModel,this.element.get(0));this.element.css("width",this.options.width);this.element.find(".ui-ciapi-authentication-button").button();this._update()},destroy:function(){a.Widget.prototype.destroy.call(this)},_update:function(){var c=CIAPI.connection.isConnected?"LogOff":"LogOn";this.options.viewModel.activeView(c);if(this.options.viewModel.errorMessage()){this.element.effect("shake",{times:2},100)}}})})(jQuery);

